<!DOCTYPE html>
<html lang="en" xmlns:https="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Bayesian Network Development and Validation</title>

    <!--------general ids------------------------>
    <script src="general_ids.js" type="text/javascript"></script>

    <!--------libraries------------------------>
    <script src="libraries/d3js.v6/d3js.v6.js" type="text/javascript"></script>
    <script src="libraries/jquery/jquery.min.js" type="text/javascript"></script>

    <script src="libraries/tooltip_tippy/popper.min.v6.js" type="text/javascript"></script>
    <script src="libraries/tooltip_tippy/tippy_v6.js" type="text/javascript"></script>

    <script src="libraries/fstdropdown/fstdropdown.min.js" type="text/javascript"></script>
    <link href="libraries/fstdropdown/fstdropdown.min.css" rel="stylesheet">

    <script src="libraries/html5sortable/html5sortable.min.js"></script>

    <script src="libraries/dagre/dagre.min.js" type="text/javascript"></script>

    <!--------multi languages------------------------>
    <script src="multi_language_strings/language_strings.js" type="text/javascript"></script>

    <!--------model------------------------>
    <script src="model/model.js" type="text/javascript"></script>
    <script src="model/model_variables.js" type="text/javascript"></script>

    <!--------controller------------------------>
    <script src="controller/controller.js" type="text/javascript"></script>

    <!--------view------------------------>
    <script src="page_transition.js" type="text/javascript"></script>
    <script src="view/data_overview_structure_learning/clinical_workflow_groups.js" type="text/javascript"></script>
    <script src="view/initialize_header.js" type="text/javascript"></script>
    <script src="view/data_overview_structure_learning/network_dagre.js" type="text/javascript"></script>

    <script src="view/structure_validation/steps.js" type="text/javascript"></script>

    <!--------style------------------------>
    <link href="style_general.css" rel="stylesheet">
    <link href="style_structural_validation.css" rel="stylesheet">
    <link href="style_network.css" rel="stylesheet">
</head>


<body>
<div class="whole_view" id="whole_view">

    <div class="heading" id="heading">
        <div class="back_button" id="id_header_back_button"></div>
        <div class="heading_text">
            <p class="h1" id="header_text"></p>
        </div>
        <div class="save_button"></div>
    </div>


    <div class="main_content" id="main_content">
        <div class="content">
            <div class="top_divs_intro_overview" id="general_information">
                <p>Since the parametrization is highly dependent on the Bayesian network structure, you firstly have to
                    validate the learnt nodes and relations.</p>
            </div>
            <div class="top_divs_intro_overview top_div_overview" id ="id_network_view"></div>
            <p class="h2">Structure Validation</p>
<!--            <div class="steps_structure_validation_div" id ="steps_structure_validation_div">-->
<!--                <p class="h3">Steps</p>-->
<!--            </div>-->
            <div class="structure_validation_div" id="structure_validation_div">
                <p class="h3">Validation</p>
                <div class="structure_validation_content_div" id="structure_validation_viewer_div"></div>
                <div class="structure_validation_content_div" id="structure_validation_modifications_div">
                    <p>abcdsfkjdl</p>
                </div>

            </div>
            <div class="steps_structure_validation_div notes_comments_structure_validation_div" id="notes_comments_structure_validation_div">
                <p class="h3">Notes/Comments</p>
                <textarea class="notes_comments_input" id ="notes_comments_text" name="Text1" placeholder="Insert your notes/comments here ..."></textarea>
                <input class="button" id="pubmed_button" onclick="go_to_pubmed()"
                       style="position:relative; float: right;">
            </div>

        </div>
    </div>
<!--    <div class="footer" id="footer">-->
<!--        <div class="content">-->
<!--            <div id="myProgress">-->
<!--                <div id="myBar">0%</div>-->
<!--            </div>-->

<!--            <input class="button" id="forward_button" style="position:relative; float: right; margin-bottom: 20px;" type="submit"-->
<!--                   value="         Parametrization Validation">-->
<!--        </div>-->
<!--    </div>-->
</div>

<script>
    current_html_page = 2;

    initialize_header(lang_id_structure_validation);
    //initialize_steps();

    function go_to_pubmed() {
        const url = "https://pubmed.ncbi.nlm.nih.gov/";
        let win = window.open(url, '_blank');
        win.focus();
    }

    load_data_from_backend(function (response) {
        if (response) {

            initialize_network_view(id_network_view, 50, false, learned_structure_data, id_network_view_child);
            //model_validation;
            console.log(learned_structure_data)
            let unvalidated_nodes = learned_structure_data.nodes.filter(x => x.structure_validated === false);
            let node_under_investigation = unvalidated_nodes[1];

            let node_validation_network_structure = {
                edges: [],
                nodes: []
            };

            node_validation_network_structure.nodes = learned_structure_data.nodes.filter(x =>
                node_under_investigation.parents.includes(x.id) ||
                node_under_investigation.children.includes(x.id) ||
                x.id === node_under_investigation.id
            );


            node_validation_network_structure.edges.push({
                edge_from: node_under_investigation.id,
                edge_to: node_under_investigation.children
            })

            node_under_investigation.parents.forEach(function (parent) {
                node_validation_network_structure.edges.push({
                    edge_from: parent,
                    edge_to: [node_under_investigation.id]
                })
            })

            console.log(node_validation_network_structure)
            initialize_network_view('structure_validation_viewer_div', 80, false, node_validation_network_structure, 'structure_validation_viewer_div_child');

        }
    })
</script>
</body>
</html>